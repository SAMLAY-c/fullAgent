# Auto-Doc Skill: 自动文档维护协议

## 核心原则
每次修改代码，文档必须同步更新。不仅是建议，是**强制执行**。

## 01 文档结构体系
我们维护三层文档，从微观到宏观：

1. 文件头注释 (File Header): 代码文件内部
2. 目录索引 (Folder Index): 每个文件夹下的 `INDEX.md`
3. 架构总览 (Architecture): 根目录的 `ARCHITECTURE.md`

## 02 强制更新流程 (Workflow)
当你进行代码变更时，必须严格按照以下顺序操作：

1. 修改代码
2. 更新文件头注释
3. 更新 `INDEX.md`
4. 更新 `ARCHITECTURE.md`（如需）

## 03 详细执行标准

### A. 文件头注释标准
每个代码文件头部必须包含以下 JSDoc/Docstring 格式注释：

```text
/**
 * @input [列出该文件的输入依赖/参数]
 * @output [列出该文件的输出/返回值]
 * @position [说明该文件在架构中的角色，如：数据层/UI组件/工具类]
 * @auto-doc [标记：修改此文件必须同步更新 INDEX.md]
 */
```

### B. `INDEX.md` 更新标准
每个包含代码的目录下必须有 `INDEX.md`。

- 头部：用 3 行以内简述当前文件夹的职责。
- 表格：列出当前目录下所有文件。
- 触发条件：
  - 新建/删除文件 -> 更新表格行。
  - 文件逻辑/输入输出变更 -> 更新表格中对应的“功能描述”。

**`INDEX.md` 模板：**

```markdown
# [目录名称] 索引
**职责**: [简述该目录的核心职责]

| 文件名 | 角色 | 功能描述 | 依赖 |
| :--- | :--- | :--- | :--- |
| example.ts | Utils | 处理日期格式化 | date-fns |
```

### C. `ARCHITECTURE.md` 更新标准
位于项目根目录。

- 触发条件：只有当“新建核心模块”、“改变数据流向”或“重构目录结构”时才更新。
- 内容：10 行以内概括整体架构 + 链接到各子目录 `INDEX.md`。

## 04 决策逻辑表 (Decision Table)

| 操作类型 | 更新头注释? | 更新 INDEX.md? | 更新 ARCHITECTURE.md? |
| :--- | :--- | :--- | :--- |
| 修改逻辑 | ✅（如 IO/逻辑变动） | ❌ | ❌ |
| 接口变更 | ✅ | ✅ | ❌ |
| 新建文件 | ✅（新建时必填） | ✅（新增一行） | ❓（如是新模块则更新） |
| 删除文件 | N/A | ✅（删除一行） | ❓（如影响架构则更新） |
| 移动文件 | ✅（更新 Position） | ✅（源目录和目标目录都更） | ❓（如影响架构则更新） |
