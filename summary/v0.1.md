# Bot Agent Platform v0.1 - é¡¹ç›®æ€»ç»“æ–‡æ¡£

**ç‰ˆæœ¬**: v0.1
**æ—¥æœŸ**: 2026-02-20
**çŠ¶æ€**: å‰åç«¯æ•°æ®å·²å®Œå…¨è¿é€š

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
3. [æ•°æ®è¿é€šæ€§çŠ¶æ€](#æ•°æ®è¿é€šæ€§çŠ¶æ€)
4. [å‰åç«¯APIç«¯ç‚¹æ˜ å°„](#å‰åç«¯apiç«¯ç‚¹æ˜ å°„)
5. [æ•°æ®æ¨¡å‹ä¸å…³ç³»](#æ•°æ®æ¨¡å‹ä¸å…³ç³»)
6. [å·²å®ç°åŠŸèƒ½](#å·²å®ç°åŠŸèƒ½)
7. [å¯æ‰©å±•æ€§åˆ†æ](#å¯æ‰©å±•æ€§åˆ†æ)
8. [å¾…å®ç°åŠŸèƒ½](#å¾…å®ç°åŠŸèƒ½)
9. [æ¶æ„ä¼˜åŠ¿](#æ¶æ„ä¼˜åŠ¿)

---

## é¡¹ç›®æ¦‚è¿°

Bot Agent Platform æ˜¯ä¸€ä¸ªæ™ºèƒ½ä½“ç®¡ç†å¹³å°ï¼Œæ”¯æŒåˆ›å»ºã€ç®¡ç†å’Œä¸å¤šä¸ªAIæ™ºèƒ½ä½“è¿›è¡Œå¯¹è¯ã€‚å¹³å°é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œåç«¯æä¾›RESTful APIï¼Œå‰ç«¯é€šè¿‡JavaScriptè¿›è¡Œæ•°æ®äº¤äº’ã€‚

**æ ¸å¿ƒç‰¹æ€§**:
- å¤šåœºæ™¯æ™ºèƒ½ä½“ç®¡ç†ï¼ˆå·¥ä½œã€ç”Ÿæ´»ã€æƒ…æ„Ÿã€ç¾¤ç»„ã€SOPï¼‰
- å®æ—¶å¯¹è¯ç³»ç»Ÿ
- å·¥ä½œæµè‡ªåŠ¨åŒ–ï¼ˆæ•°æ®åº“æ¨¡å‹å·²å°±ç»ªï¼‰
- çŸ¥è¯†åº“ç®¡ç†ï¼ˆæ•°æ®åº“æ¨¡å‹å·²å°±ç»ªï¼‰
- è®°å¿†ç³»ç»Ÿï¼ˆæ•°æ®åº“æ¨¡å‹å·²å°±ç»ªï¼‰
- ç¾¤ç»„åä½œï¼ˆæ•°æ®åº“æ¨¡å‹å·²å°±ç»ªï¼‰

---

## æŠ€æœ¯æ ˆ

### åç«¯
- **è¿è¡Œæ—¶**: Node.js 5.7.2
- **æ¡†æ¶**: Express 4.21.2
- **è¯­è¨€**: TypeScript
- **æ•°æ®åº“**: PostgreSQL (via Docker)
- **ORM**: Prisma 5.22.0
- **è®¤è¯**: JWT (access_token + refresh_token)
- **å¯†ç åŠ å¯†**: bcrypt

### å‰ç«¯
- **æŠ€æœ¯æ ˆ**: Vanilla HTML/CSS/JavaScript (æ— æ¡†æ¶)
- **æ¶æ„**: æ¨¡å—åŒ–JavaScript (ES6+)
- **æœåŠ¡å™¨**: Python http.server 8080
- **ç‰¹æ€§**: å“åº”å¼è®¾è®¡ã€ç»„ä»¶åŒ–ç»“æ„

### å¼€å‘å·¥å…·
- **åç«¯æœåŠ¡å™¨**: http://localhost:3000
- **å‰ç«¯æœåŠ¡å™¨**: http://localhost:8080
- **æ•°æ®åº“**: PostgreSQL @ localhost:5432 (Dockerå®¹å™¨: bot_agent_db)

---

## æ•°æ®è¿é€šæ€§çŠ¶æ€

### âœ… å®Œå…¨è¿é€šçš„åŠŸèƒ½

| åŠŸèƒ½æ¨¡å— | å‰ç«¯é¡µé¢ | åç«¯API | æ•°æ®åº“ | çŠ¶æ€ |
|---------|---------|---------|--------|------|
| ç”¨æˆ·è®¤è¯ | login.js | `/api/auth/*` | Userè¡¨ | âœ… å·²è¿é€š |
| Botåˆ—è¡¨æŸ¥çœ‹ | admin.js | `GET /api/bots` | Botè¡¨ | âœ… å·²è¿é€š |
| Botåˆ›å»º | admin.js | `POST /api/bots` | Botè¡¨ | âœ… å·²è¿é€š |
| Botç¼–è¾‘ | admin.js | `PUT /api/bots/:id` | Botè¡¨ | âœ… å·²è¿é€š |
| Botåˆ é™¤ | admin.js | `DELETE /api/bots/:id` | Botè¡¨ | âœ… å·²è¿é€š |
| BotçŠ¶æ€åˆ‡æ¢ | admin.js | `PUT /api/bots/:id/status` | Botè¡¨ | âœ… å·²è¿é€š |
| å¯¹è¯åˆ—è¡¨ | chat.js | `GET /api/chat/conversations` | Conversationè¡¨ | âœ… å·²è¿é€š |
| å¯¹è¯åˆ›å»º | chat.js | `POST /api/chat/conversations` | Conversationè¡¨ | âœ… å·²è¿é€š |
| æ¶ˆæ¯å†å² | chat.js | `GET /api/chat/conversations/:id/messages` | Messageè¡¨ | âœ… å·²è¿é€š |
| æ¶ˆæ¯å‘é€ | chat.js | `POST /api/chat/conversations/:id/messages` | Messageè¡¨ | âœ… å·²è¿é€š |
| Dashboardç»Ÿè®¡ | admin.js (Dashboardæ¨¡å—) | `GET /api/stats/dashboard` | èšåˆæŸ¥è¯¢ | âœ… å·²è¿é€š |
| æœ€è¿‘æ´»åŠ¨ | admin.js (Dashboardæ¨¡å—) | `GET /api/stats/recent-activities` | å¤šè¡¨å…³è” | âœ… å·²è¿é€š |

### ğŸ”„ æ•°æ®åº“æ¨¡å‹å°±ç»ªï¼ˆå¾…å®ç°APIï¼‰

| åŠŸèƒ½æ¨¡å— | æ•°æ®æ¨¡å‹ | çŠ¶æ€ |
|---------|---------|------|
| å·¥ä½œæµç®¡ç† | Workflow, WorkflowExecution | ğŸŸ¡ æ¨¡å‹å·²å°±ç»ªï¼ŒAPIå¾…å®ç° |
| ç¾¤ç»„åä½œ | Group, GroupMember, GroupMessage | ğŸŸ¡ æ¨¡å‹å·²å°±ç»ªï¼ŒAPIå¾…å®ç° |
| è®°å¿†ç³»ç»Ÿ | Memory | ğŸŸ¡ æ¨¡å‹å·²å°±ç»ªï¼ŒAPIå¾…å®ç° |
| çŸ¥è¯†åº“ | KnowledgeFile, KnowledgeChunk | ğŸŸ¡ æ¨¡å‹å·²å°±ç»ªï¼ŒAPIå¾…å®ç° |

---

## å‰åç«¯APIç«¯ç‚¹æ˜ å°„

### 1. è®¤è¯æ¨¡å— (auth-manager.js â†” auth.ts)

| å‰ç«¯è°ƒç”¨ | åç«¯ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ |
|---------|---------|------|------|
| `authManager.login()` | `/api/auth/login` | POST | ç”¨æˆ·ç™»å½•ï¼Œè¿”å›JWT token |
| `authManager.logout()` | `/api/auth/logout` | POST | ç”¨æˆ·ç™»å‡ºï¼Œæ¸…é™¤token |
| `authManager.getCurrentUser()` | `/api/auth/me` | GET | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| (è‡ªåŠ¨) | `/api/auth/refresh` | POST | åˆ·æ–°è®¿é—®ä»¤ç‰Œï¼ˆ401æ—¶è‡ªåŠ¨è°ƒç”¨ï¼‰ |

**æ•°æ®æµ**:
```
login.html â†’ authManager.login()
  â†’ POST /api/auth/login
  â†’ è¿”å› { access_token, refresh_token, user }
  â†’ å­˜å‚¨åˆ° localStorage
  â†’ è·³è½¬åˆ°èŠå¤©ç•Œé¢
```

### 2. Botç®¡ç†æ¨¡å— (bot-client.js â†” bots.ts)

| å‰ç«¯è°ƒç”¨ | åç«¯ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ |
|---------|---------|------|------|
| `botClient.getBots()` | `/api/bots` | GET | è·å–Botåˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€è¿‡æ»¤ï¼‰ |
| `botClient.getBot(botId)` | `/api/bots/:botId` | GET | è·å–å•ä¸ªBotè¯¦æƒ… |
| `botClient.createBot(data)` | `/api/bots` | POST | åˆ›å»ºæ–°Bot |
| `botClient.updateBot(botId, data)` | `/api/bots/:botId` | PUT | æ›´æ–°Botä¿¡æ¯ |
| `botClient.deleteBot(botId)` | `/api/bots/:botId` | DELETE | åˆ é™¤Bot |
| `botClient.updateBotStatus(botId, status)` | `/api/bots/:botId/status` | PUT | æ›´æ–°BotçŠ¶æ€ |
| `botClient.getConversations(botId)` | `/api/bots/:botId/conversations` | GET | è·å–Botçš„å¯¹è¯åˆ—è¡¨ |

**æŸ¥è¯¢å‚æ•°æ”¯æŒ**:
- `type`: æŒ‰ç±»å‹è¿‡æ»¤ (work, life, love, group, sop)
- `status`: æŒ‰çŠ¶æ€è¿‡æ»¤ (online, offline, suspended)
- `scene`: æŒ‰åœºæ™¯è¿‡æ»¤
- `page`, `page_size`: åˆ†é¡µ

**æ•°æ®æµ**:
```
admin.js â†’ botClient.getBots({ type: 'work' })
  â†’ GET /api/bots?type=work
  â†’ PrismaæŸ¥è¯¢: prisma.bot.findMany({ where: { type: 'work' } })
  â†’ è¿”å›Botæ•°ç»„
  â†’ æ¸²æŸ“åˆ°bot-admin-ui-v2.htmlçš„Botåˆ—è¡¨
```

### 3. èŠå¤©æ¨¡å— (chat.js â†” chat.ts)

| å‰ç«¯è°ƒç”¨ | åç«¯ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ |
|---------|---------|------|------|
| `getConversationsByScene(botId)` | `/api/chat/conversations?bot_id=xxx` | GET | è·å–å¯¹è¯åˆ—è¡¨ |
| `createConversation(botId, title)` | `/api/chat/conversations` | POST | åˆ›å»ºæ–°å¯¹è¯ |
| `loadMessages(conversationId)` | `/api/chat/conversations/:id/messages` | GET | è·å–æ¶ˆæ¯å†å² |
| `sendMessage(conversationId, content)` | `/api/chat/conversations/:id/messages` | POST | å‘é€æ–°æ¶ˆæ¯ |

**æ•°æ®æµ**:
```
chat.js â†’ sendMessage(conversationId, "ä½ å¥½")
  â†’ POST /api/chat/conversations/{id}/messages
  â†’ ä¿å­˜åˆ°Messageè¡¨
  â†’ è¿”å›ä¿å­˜çš„æ¶ˆæ¯
  â†’ å‰ç«¯æ¸²æŸ“åˆ°èŠå¤©ç•Œé¢
  â†’ æ›´æ–°æœ€åæ¶ˆæ¯æ—¶é—´
```

### 4. ç»Ÿè®¡æ¨¡å— (admin.js Dashboard â†” stats.ts)

| å‰ç«¯è°ƒç”¨ | åç«¯ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ |
|---------|---------|------|------|
| `loadDashboardStats()` | `/api/stats/dashboard` | GET | è·å–ä»ªè¡¨ç›˜ç»Ÿè®¡æ•°æ® |
| `loadRecentActivities()` | `/api/stats/recent-activities` | GET | è·å–æœ€è¿‘æ´»åŠ¨è®°å½• |

**Dashboardç»Ÿè®¡æ•°æ®**:
```javascript
{
  bots: {
    total: 13,           // æ€»Botæ•°
    online: 7,           // åœ¨çº¿Botæ•°
    trend: "+2"          // è¶‹åŠ¿
  },
  workflows: {
    total: 0,
    enabled: 0,
    trend: "0%"
  },
  groups: {
    total: 2,
    active: 1,
    trend: "+1"
  },
  messages: {
    todayCount: 0,
    totalConversations: 0,
    trend: "0%"
  }
}
```

---

## æ•°æ®æ¨¡å‹ä¸å…³ç³»

### æ ¸å¿ƒå®ä½“å…³ç³»å›¾

```
User (ç”¨æˆ·)
  â†“ 1:N
Bot (æ™ºèƒ½ä½“)
  â†“ 1:N         â†“ 1:N
Conversation  Workflow  Group  â†â†’  GroupMember  â†â†’  Bot
Message        Execution              (N:M)
  â†“
Memory (è®°å¿†)
  â†“
KnowledgeFile (çŸ¥è¯†åº“æ–‡ä»¶)
  â†“
KnowledgeChunk (çŸ¥è¯†å—)
```

### æ•°æ®æ¨¡å‹å®šä¹‰

#### User (ç”¨æˆ·)
```typescript
{
  user_id: string          // ä¸»é”®
  username: string         // å”¯ä¸€
  email: string           // å”¯ä¸€
  password_hash: string   // bcryptåŠ å¯†
  avatar: string?         // å¤´åƒemoji
  role: 'admin' | 'user'  // è§’è‰²
  created_at: DateTime
  updated_at: DateTime
}
```

#### Bot (æ™ºèƒ½ä½“)
```typescript
{
  bot_id: string
  name: string            // åç§°ï¼Œæœ€é•¿50å­—ç¬¦
  avatar: string?         // å¤´åƒ
  type: string           // work | life | love | group | sop
  scene: string          // work | life | love | group | sop
  status: string         // online | offline | suspended
  description: string?   // æè¿°ï¼Œæœ€é•¿500å­—ç¬¦
  config: Json?          // { model, temperature, max_tokens, system_prompt }
  created_at: DateTime
  updated_at: DateTime
}
```

#### Conversation (å¯¹è¯)
```typescript
{
  conversation_id: string
  bot_id: string         // å¤–é”® â†’ Bot
  user_id: string        // å¤–é”® â†’ User
  title: string?
  created_at: DateTime
  updated_at: DateTime
}
```

#### Message (æ¶ˆæ¯)
```typescript
{
  message_id: string
  conversation_id: string // å¤–é”® â†’ Conversation
  sender_type: string    // 'user' | 'bot' | 'system'
  sender_id: string
  content: string        // @db.Text
  metadata: Json?        // { model, usage, mentioned_bots }
  timestamp: DateTime
}
```

#### Workflow (å·¥ä½œæµ) - æ¨¡å‹å·²å°±ç»ª
```typescript
{
  workflow_id: string
  bot_id: string         // å¤–é”® â†’ Bot
  name: string
  description: string?
  triggers: Json         // [{ type, expression, timezone }]
  workflow_steps: Json   // [{ step, action, content, ai_generate }]
  enabled: boolean
  created_at: DateTime
  updated_at: DateTime
}
```

#### Group (ç¾¤ç»„) - æ¨¡å‹å·²å°±ç»ª
```typescript
{
  group_id: string
  name: string
  type: string          // personal | team | public
  description: string?
  routing_strategy: string // keyword_match | ai_judge | round_robin
  conversation_mode: string  // single_turn | multi_turn
  created_by: string
  created_at: DateTime
  updated_at: DateTime
}
```

#### Memory (è®°å¿†) - æ¨¡å‹å·²å°±ç»ª
```typescript
{
  memory_id: string
  bot_id: string
  user_id: string
  type: string          // conversation | preference | fact | instruction
  content: string       // @db.Text
  importance: float     // 0-1
  created_at: DateTime
  updated_at: DateTime
}
```

#### KnowledgeFile (çŸ¥è¯†åº“) - æ¨¡å‹å·²å°±ç»ª
```typescript
{
  file_id: string
  bot_id: string?
  filename: string
  file_size: int
  status: string        // uploading | processing | ready | failed
  error_message: string?
  created_at: DateTime
  updated_at: DateTime
}
```

---

## å·²å®ç°åŠŸèƒ½

### âœ… ç”¨æˆ·è®¤è¯
- [x] ç™»å½•/ç™»å‡º
- [x] JWT Tokenç®¡ç† (access_token + refresh_token)
- [x] Tokenè‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- [x] è®¤è¯ä¸­é—´ä»¶ä¿æŠ¤è·¯ç”±
- [x] æ¼”ç¤ºè´¦å· (admin/admin123)

### âœ… Botç®¡ç†
- [x] åˆ›å»ºBot (æ”¯æŒ5ç§ç±»å‹/åœºæ™¯)
- [x] æŸ¥çœ‹Botåˆ—è¡¨ (æ”¯æŒè¿‡æ»¤ã€åˆ†é¡µ)
- [x] ç¼–è¾‘Botä¿¡æ¯
- [x] åˆ é™¤Bot
- [x] åˆ‡æ¢BotçŠ¶æ€ (online/offline/suspended)
- [x] Boté…ç½®å­˜å‚¨ (model, temperature, system_promptç­‰)

### âœ… å¯¹è¯ç³»ç»Ÿ
- [x] åˆ›å»ºå¯¹è¯
- [x] æŸ¥çœ‹å¯¹è¯åˆ—è¡¨
- [x] åŠ è½½æ¶ˆæ¯å†å²
- [x] å‘é€/æ¥æ”¶æ¶ˆæ¯
- [x] æŒ‰åœºæ™¯åˆ†ç»„æ˜¾ç¤ºBot
- [x] å®æ—¶æ¶ˆæ¯æ˜¾ç¤º

### âœ… Dashboardç»Ÿè®¡
- [x] å®æ—¶ç»Ÿè®¡å±•ç¤º (æ€»Botæ•°ã€åœ¨çº¿Botæ•°)
- [x] å·¥ä½œæµç»Ÿè®¡
- [x] ç¾¤ç»„ç»Ÿè®¡
- [x] æ¶ˆæ¯ç»Ÿè®¡
- [x] æœ€è¿‘æ´»åŠ¨è®°å½•
- [x] è¶‹åŠ¿æ•°æ®å±•ç¤º

### âœ… å‰ç«¯ç•Œé¢
- [x] ç™»å½•é¡µé¢ (login.html)
- [x] èŠå¤©ç•Œé¢ (bot-chat-ui-v2.html)
- [x] ç®¡ç†åå° (bot-admin-ui-v2.html)
- [x] å“åº”å¼è®¾è®¡
- [x] Tabå¯¼èˆª (å¯¹è¯/è®°å¿†/çŸ¥è¯†åº“/è®¾ç½®)
- [x] åœºæ™¯åˆ‡æ¢

### âœ… åç«¯æ¶æ„
- [x] RESTful APIè®¾è®¡
- [x] Prisma ORMé›†æˆ
- [x] ç»Ÿä¸€é”™è¯¯å¤„ç†
- [x] CORSé…ç½®
- [x] è¯·æ±‚éªŒè¯
- [x] æ—¥å¿—ç³»ç»Ÿ

---

## å¯æ‰©å±•æ€§åˆ†æ

### ğŸš€ é«˜æ‰©å±•æ€§é¢†åŸŸ

#### 1. AIæ¨¡å‹é›†æˆ
**å½“å‰çŠ¶æ€**: Bot.configå­—æ®µå·²é¢„ç•™
**æ‰©å±•æ–¹å‘**:
```typescript
// configå­—æ®µå¯ä»¥å­˜å‚¨:
{
  model: "gpt-4" | "claude-3-opus" | "custom",
  temperature: 0.7,
  max_tokens: 2000,
  system_prompt: "ä½ æ˜¯...",
  api_key: "sk-...",
  provider: "openai" | "anthropic" | "custom"
}
```
**ä¼˜åŠ¿**: æ— éœ€ä¿®æ”¹æ•°æ®åº“schemaï¼Œå³å¯æ”¯æŒå¤šç§AIæ¨¡å‹

#### 2. å·¥ä½œæµè‡ªåŠ¨åŒ–
**å½“å‰çŠ¶æ€**: æ•°æ®æ¨¡å‹å®Œæ•´ï¼ŒAPIå¾…å®ç°
**æ‰©å±•æ–¹å‘**:
- å®šæ—¶æé†’ (Cronè§¦å‘)
- äº‹ä»¶é©±åŠ¨ (æ¶ˆæ¯è§¦å‘ã€å¤–éƒ¨Webhook)
- AIç”Ÿæˆå†…å®¹ (workflow_steps.ai_generate)
- å¤šæ­¥éª¤ç¼–æ’ (workflow_stepsæ•°ç»„)
- æ‰§è¡Œå†å²è¿½è¸ª (WorkflowExecutionè¡¨)

**å®ç°å»ºè®®**:
```typescript
// éœ€è¦æ·»åŠ çš„API:
POST /api/workflows           // åˆ›å»ºå·¥ä½œæµ
GET  /api/workflows           // è·å–å·¥ä½œæµåˆ—è¡¨
PUT  /api/workflows/:id       // æ›´æ–°å·¥ä½œæµ
DELETE /api/workflows/:id     // åˆ é™¤å·¥ä½œæµ
POST /api/workflows/:id/execute  // æ‰‹åŠ¨æ‰§è¡Œ
GET  /api/workflows/:id/executions  // æ‰§è¡Œå†å²
```

#### 3. ç¾¤ç»„åä½œ
**å½“å‰çŠ¶æ€**: æ•°æ®æ¨¡å‹å®Œæ•´ï¼ŒAPIå¾…å®ç°
**æ‰©å±•æ–¹å‘**:
- å¤šBotåä½œ (GroupMemberå…³è”å¤šä¸ªBot)
- æ™ºèƒ½è·¯ç”±:
  - keyword_match: å…³é”®è¯è§¦å‘ç‰¹å®šBot
  - ai_judge: AIåˆ¤æ–­è·¯ç”±åˆ°å“ªä¸ªBot
  - round_robin: è½®è¯¢
  - broadcast: å¹¿æ’­ç»™æ‰€æœ‰Bot
- æƒé™ç®¡ç† (GroupMember.permissions)
- è‡ªå®šä¹‰è§’è‰² (GroupMember.role)

**å®ç°å»ºè®®**:
```typescript
// éœ€è¦æ·»åŠ çš„API:
POST /api/groups              // åˆ›å»ºç¾¤ç»„
GET  /api/groups              // è·å–ç¾¤ç»„åˆ—è¡¨
PUT  /api/groups/:id          // æ›´æ–°ç¾¤ç»„
POST /api/groups/:id/members  // æ·»åŠ æˆå‘˜
DELETE /api/groups/:id/members/:botId  // ç§»é™¤æˆå‘˜
POST /api/groups/:id/message  // å‘é€ç¾¤æ¶ˆæ¯
```

#### 4. è®°å¿†ç³»ç»Ÿ
**å½“å‰çŠ¶æ€**: æ•°æ®æ¨¡å‹å®Œæ•´ï¼ŒAPIå¾…å®ç°
**æ‰©å±•æ–¹å‘**:
- å¯¹è¯è®°å¿† (type=conversation)
- ç”¨æˆ·åå¥½ (type=preference)
- äº‹å®å­˜å‚¨ (type=fact)
- æŒ‡ä»¤è®°å¿† (type=instruction)
- é‡è¦æ€§è¯„åˆ† (importance: 0-1)
- è®°å¿†æ£€ç´¢å’Œæ³¨å…¥åˆ°å¯¹è¯ä¸Šä¸‹æ–‡

**å®ç°å»ºè®®**:
```typescript
// éœ€è¦æ·»åŠ çš„API:
GET  /api/bots/:id/memories       // è·å–Botè®°å¿†
POST /api/bots/:id/memories       // åˆ›å»ºè®°å¿†
PUT  /api/bots/:id/memories/:id   // æ›´æ–°è®°å¿†
DELETE /api/bots/:id/memories/:id // åˆ é™¤è®°å¿†
GET  /api/memories/search         // è®°å¿†æœç´¢
```

#### 5. çŸ¥è¯†åº“ (RAG)
**å½“å‰çŠ¶æ€**: æ•°æ®æ¨¡å‹å®Œæ•´ï¼ŒAPIå¾…å®ç°
**æ‰©å±•æ–¹å‘**:
- æ–‡ä»¶ä¸Šä¼  (PDF, Word, Excel, TXT)
- æ–‡ä»¶åˆ†å— (KnowledgeChunk)
- å‘é‡åŒ–å­˜å‚¨ (å¯æ·»åŠ vectorå­—æ®µ)
- è¯­ä¹‰æœç´¢
- çŸ¥è¯†æ³¨å…¥åˆ°å¯¹è¯ä¸Šä¸‹æ–‡

**å®ç°å»ºè®®**:
```typescript
// éœ€è¦æ·»åŠ çš„API:
POST /api/knowledge/upload        // ä¸Šä¼ æ–‡ä»¶
GET  /api/knowledge/files         // è·å–æ–‡ä»¶åˆ—è¡¨
DELETE /api/knowledge/files/:id   // åˆ é™¤æ–‡ä»¶
POST /api/knowledge/search        // çŸ¥è¯†æœç´¢
```

#### 6. å¤šç§Ÿæˆ·æ”¯æŒ
**å½“å‰çŠ¶æ€**: Userè¡¨å·²æœ‰roleå­—æ®µ
**æ‰©å±•æ–¹å‘**:
- æ·»åŠ Tenantè¡¨
- ç”¨æˆ·éš”ç¦»
- èµ„æºé…é¢ç®¡ç†
- APIé™æµ

#### 7. å®æ—¶é€šä¿¡
**å½“å‰çŠ¶æ€**: è½®è¯¢æ–¹å¼
**æ‰©å±•æ–¹å‘**:
- WebSocketé›†æˆ (Socket.io / ws)
- Server-Sent Events (SSE)
- å®æ—¶æ¶ˆæ¯æ¨é€
- åœ¨çº¿çŠ¶æ€åŒæ­¥

#### 8. æ’ä»¶ç³»ç»Ÿ
**æ‰©å±•æ–¹å‘**:
- æ’ä»¶æ³¨å†Œæœºåˆ¶
- æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†
- æ’ä»¶API (before_message, after_message)
- ç¤¾åŒºæ’ä»¶å¸‚åœº

---

## å¾…å®ç°åŠŸèƒ½

### ğŸ”§ çŸ­æœŸ (1-2å‘¨)

1. **å·¥ä½œæµAPIå®ç°**
   - [ ] åˆ›å»ºå·¥ä½œæµè·¯ç”± (`backend/src/routes/workflows.ts`)
   - [ ] å®ç°CRUDæ“ä½œ
   - [ ] å®ç°è§¦å‘å™¨è°ƒåº¦ (node-cron)
   - [ ] å‰ç«¯å·¥ä½œæµç®¡ç†ç•Œé¢

2. **çŸ¥è¯†åº“åŸºç¡€åŠŸèƒ½**
   - [ ] æ–‡ä»¶ä¸Šä¼ API
   - [ ] æ–‡ä»¶è§£æ (PDF, Word)
   - [ ] ç®€å•çš„åˆ†å—é€»è¾‘
   - [ ] å‰ç«¯æ–‡ä»¶ä¸Šä¼ ç•Œé¢

3. **è®°å¿†ç³»ç»ŸAPI**
   - [ ] è®°å¿†CRUDæ“ä½œ
   - [ ] è®°å¿†æ£€ç´¢
   - [ ] å‰ç«¯è®°å¿†å±•ç¤ºç•Œé¢

### ğŸ¯ ä¸­æœŸ (1-2æœˆ)

1. **ç¾¤ç»„åä½œå®Œæ•´å®ç°**
   - [ ] ç¾¤ç»„ç®¡ç†API
   - [ ] æ™ºèƒ½è·¯ç”±é€»è¾‘
   - [ ] ç¾¤ç»„èŠå¤©ç•Œé¢
   - [ ] æˆå‘˜ç®¡ç†

2. **RAGé›†æˆ**
   - [ ] å‘é‡æ•°æ®åº“é›†æˆ (Pinecone / Milvus)
   - [ ] è¯­ä¹‰æœç´¢
   - [ ] ä¸Šä¸‹æ–‡æ³¨å…¥

3. **å®æ—¶é€šä¿¡**
   - [ ] WebSocketé›†æˆ
   - [ ] å®æ—¶æ¶ˆæ¯æ¨é€
   - [ ] åœ¨çº¿çŠ¶æ€

### ğŸš€ é•¿æœŸ (3-6æœˆ)

1. **å¤šæ¨¡å‹æ”¯æŒ**
   - [ ] OpenAIé›†æˆ
   - [ ] Claudeé›†æˆ
   - [ ] æœ¬åœ°æ¨¡å‹ (Ollama)
   - [ ] æ¨¡å‹åˆ‡æ¢ç•Œé¢

2. **æ’ä»¶ç³»ç»Ÿ**
   - [ ] æ’ä»¶æ¶æ„è®¾è®¡
   - [ ] æ’ä»¶APIè§„èŒƒ
   - [ ] å®˜æ–¹æ’ä»¶å¼€å‘

3. **ä¼ä¸šåŠŸèƒ½**
   - [ ] å¤šç§Ÿæˆ·æ”¯æŒ
   - [ ] RBACæƒé™ç³»ç»Ÿ
   - [ ] å®¡è®¡æ—¥å¿—
   - [ ] æ•°æ®å¯¼å‡º

---

## æ¶æ„ä¼˜åŠ¿

### âœ… ä¼˜åŠ¿

1. **æ¸…æ™°çš„åˆ†å±‚æ¶æ„**
   - è·¯ç”±å±‚ â†’ æœåŠ¡å±‚ â†’ æ•°æ®å±‚
   - æ˜“äºç»´æŠ¤å’Œæµ‹è¯•
   - èŒè´£åˆ†æ˜

2. **å®Œæ•´çš„æ•°æ®æ¨¡å‹**
   - è¦†ç›–å¤æ‚ä¸šåŠ¡åœºæ™¯
   - å…³ç³»è®¾è®¡åˆç†
   - æ˜“äºæ‰©å±•

3. **ç»Ÿä¸€é”™è¯¯å¤„ç†**
   - æ ‡å‡†åŒ–é”™è¯¯å“åº”
   - æ¸…æ™°çš„é”™è¯¯ç 
   - ä¾¿äºè°ƒè¯•

4. **å‰åç«¯åˆ†ç¦»**
   - ç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²
   - APIä¼˜å…ˆè®¾è®¡
   - æ˜“äºæ‰©å±•å‰ç«¯

5. **ç±»å‹å®‰å…¨**
   - TypeScriptå…¨è¦†ç›–
   - Prismaç±»å‹ç”Ÿæˆ
   - å‡å°‘è¿è¡Œæ—¶é”™è¯¯

6. **æ¨¡å—åŒ–å‰ç«¯**
   - ES6æ¨¡å—ç³»ç»Ÿ
   - åŠŸèƒ½è§£è€¦
   - æ˜“äºç»´æŠ¤

### âš ï¸ æ½œåœ¨æ”¹è¿›

1. **å‰ç«¯çŠ¶æ€ç®¡ç†**
   - å½“å‰: localStorage
   - å»ºè®®: å¼•å…¥è½»é‡çº§çŠ¶æ€ç®¡ç† (Zustand / Pinia)

2. **APIæ–‡æ¡£**
   - å½“å‰: æ— 
   - å»ºè®®: é›†æˆSwagger/OpenAPI

3. **æµ‹è¯•è¦†ç›–**
   - å½“å‰: æ— 
   - å»ºè®®: æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

4. **ç¼“å­˜ç­–ç•¥**
   - å½“å‰: æ— 
   - å»ºè®®: Redisç¼“å­˜çƒ­ç‚¹æ•°æ®

5. **æ—¥å¿—ç³»ç»Ÿ**
   - å½“å‰: console.log
   - å»ºè®®: Winston / Pino

---

## æ€»ç»“

Bot Agent Platform v0.1 å·²ç»å®Œæˆäº†æ ¸å¿ƒåŠŸèƒ½çš„å‰åç«¯è¿é€šï¼Œå…·å¤‡ï¼š

âœ… **å®Œæ•´çš„è®¤è¯ç³»ç»Ÿ**
âœ… **Botå…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†**
âœ… **å®æ—¶å¯¹è¯åŠŸèƒ½**
âœ… **Dashboardæ•°æ®ç»Ÿè®¡**
âœ… **æ‰©å±•æ€§å¼ºçš„æ•°æ®æ¨¡å‹**
âœ… **AIæ¨¡å‹é›†æˆ** (NEW!)

**æŠ€æœ¯äº®ç‚¹**:
- æ¸…æ™°çš„RESTful APIè®¾è®¡
- å®Œå–„çš„æ•°æ®åº“æ¨¡å‹
- å‰åç«¯å®Œå…¨è§£è€¦
- æ”¯æŒå¤šç§AIæ¨¡å‹æ‰©å±•
- å·¥ä½œæµ/ç¾¤ç»„/è®°å¿†/çŸ¥è¯†åº“æ¨¡å‹å·²å°±ç»ª

**ä¸‹ä¸€æ­¥é‡ç‚¹**:
1. ~~å®ç°å·¥ä½œæµAPI~~
2. ~~å®ç°çŸ¥è¯†åº“ä¸Šä¼ ~~
3. ~~å®ç°è®°å¿†ç³»ç»Ÿ~~
4. ~~é›†æˆçœŸå®AIæ¨¡å‹~~ âœ… å·²å®Œæˆ
5. å®ç°å·¥ä½œæµè‡ªåŠ¨åŒ–
6. å®ç°ç¾¤ç»„åä½œåŠŸèƒ½
7. å®ç°çŸ¥è¯†åº“RAG
8. å®ç°è®°å¿†ç³»ç»Ÿ

**é¡¹ç›®çŠ¶æ€**: ğŸŸ¢ **ReAct Agentå·²å®Œæˆï¼ŒBotå…·å¤‡æ™ºèƒ½å·¥å…·è°ƒç”¨èƒ½åŠ›**

---

## ğŸ¤– v0.2 æ›´æ–°æ—¥å¿— - ReAct Agentå®ç° (2026-02-20)

### ä»€ä¹ˆæ˜¯ReAct Agentï¼Ÿ

ReAct (Reasoning + Acting) æ˜¯ä¸€ç§è®©AIæ¨¡å‹é€šè¿‡**æ¨ç†**å’Œ**è¡ŒåŠ¨**å¾ªç¯æ¥è§£å†³å¤æ‚ä»»åŠ¡çš„èŒƒå¼ï¼š

```
Thought (æ€è€ƒ) â†’ Action (è¡ŒåŠ¨) â†’ Observation (è§‚å¯Ÿ) â†’ ... â†’ Answer (ç­”æ¡ˆ)
```

### æ–°å¢åŠŸèƒ½

#### 1. AIæœåŠ¡æ”¯æŒTool Calling ([backend/src/services/ai.service.ts](backend/src/services/ai.service.ts))

**æ ¸å¿ƒå˜æ›´**:
```typescript
// æ–°å¢è¿”å›ç±»å‹
interface AIResult {
  type: 'text' | 'tool_calls';  // ç›´æ¥å›å¤ OR ä½¿ç”¨å·¥å…·
  content?: string;              // æ–‡æœ¬å†…å®¹
  tool_calls?: ToolCall[];       // å·¥å…·è°ƒç”¨åˆ—è¡¨
  rawMessage?: any;              // å®Œæ•´æ¶ˆæ¯(ç”¨äºå†å²)
  tokensUsed?: number;           // Tokenæ¶ˆè€—
}

// æ”¯æŒå·¥å…·å‚æ•°
async generateResponse(
  messages: ChatMessage[],
  botConfig?: BotConfig,
  tools?: Tool[]  // NEW: å·¥å…·å®šä¹‰
): Promise<AIResult>
```

#### 2. å·¥å…·ç³»ç»Ÿ ([backend/src/services/tools.service.ts](backend/src/services/tools.service.ts))

**å·²å®ç°å·¥å…·**:

**memory_recall** - è®°å¿†æ£€ç´¢:
```typescript
{
  name: 'memory_recall',
  description: 'ä»è®°å¿†åº“æ£€ç´¢ç”¨æˆ·ç›¸å…³ä¿¡æ¯',
  parameters: {
    query: string,    // æœç´¢å…³é”®è¯
    limit: number     // è¿”å›æ•°é‡(é»˜è®¤5)
  }
}
```

**knowledge_search** - çŸ¥è¯†åº“æœç´¢:
```typescript
{
  name: 'knowledge_search',
  description: 'ä»çŸ¥è¯†åº“æœç´¢ç›¸å…³æ–‡æ¡£å†…å®¹',
  parameters: {
    query: string,    // æœç´¢å…³é”®è¯
    limit: number     // è¿”å›æ•°é‡(é»˜è®¤3)
  }
}
```

**åŠ¨æ€å·¥å…·åˆ†é…**:
- work/life/sop/group: memory_recall + knowledge_search
- love: memory_recall (æƒ…æ„ŸBotåªéœ€è¦è®°å¿†)

#### 3. ReActæ¨ç†å¾ªç¯ ([backend/src/services/chat.service.ts](backend/src/services/chat.service.ts))

**å®Œæ•´å®ç°**:
```typescript
// ReActå¾ªç¯ (æœ€å¤š8æ¬¡è¿­ä»£)
for (let iteration = 0; iteration < MAX_ITERATIONS; iteration++) {
  const result = await aiService.generateResponse(messages, botConfig, tools);

  if (result.type === 'text') {
    // AIç›´æ¥å›å¤ â†’ ç»“æŸå¾ªç¯
    finalReply = result.content;
    break;
  }

  if (result.type === 'tool_calls') {
    // AIå†³å®šä½¿ç”¨å·¥å…· â†’ æ‰§è¡Œå·¥å…· â†’ ç»§ç»­å¾ªç¯
    messages.push(result.rawMessage);  // ä¿å­˜AIçš„tool_callsæ¶ˆæ¯

    for (const toolCall of result.tool_calls) {
      const execResult = await toolsService.executeTool(toolCall, userId, botId);
      toolCallLog.push({ tool: toolCall.function.name, result: execResult });

      messages.push({
        role: 'tool',
        tool_call_id: toolCall.id,
        content: execResult.result
      });
    }
    // ç»§ç»­å¾ªç¯ï¼ŒAIåŸºäºå·¥å…·ç»“æœå†æ¬¡æ€è€ƒ
  }
}
```

### ReActå·¥ä½œæµç¨‹ç¤ºä¾‹

**ç”¨æˆ·æ¶ˆæ¯**: "Do you remember what I told you about my work preferences?"

**ReActæ¨ç†è¿‡ç¨‹**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿­ä»£ 1: AIæ€è€ƒ                                             â”‚
â”‚ "ç”¨æˆ·é—®å·¥ä½œåå¥½ï¼Œæˆ‘éœ€è¦å…ˆæœç´¢è®°å¿†"                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¡ŒåŠ¨ 1: è°ƒç”¨ memory_recall å·¥å…·                           â”‚
â”‚ å‚æ•°: {"query": "å·¥ä½œåå¥½ work preferences", "limit": 5}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è§‚å¯Ÿ 1: å·¥å…·è¿”å›                                           â”‚
â”‚ "æ²¡æœ‰æ‰¾åˆ°å…³äº'å·¥ä½œåå¥½ work preferences'çš„ç›¸å…³è®°å¿†"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿­ä»£ 2: AIå†æ¬¡æ€è€ƒ                                        â”‚
â”‚ "è®°å¿†ä¸­æ²¡æœ‰ï¼Œè¯•è¯•çŸ¥è¯†åº“"                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¡ŒåŠ¨ 2: è°ƒç”¨ knowledge_search å·¥å…·                        â”‚
â”‚ å‚æ•°: {"query": "å·¥ä½œåå¥½", "limit": 3}                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è§‚å¯Ÿ 2: å·¥å…·è¿”å›                                           â”‚
â”‚ "çŸ¥è¯†åº“ä¸­æ²¡æœ‰æ‰¾åˆ°å…³äº'å·¥ä½œåå¥½'çš„ç›¸å…³å†…å®¹"                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿­ä»£ 3: AIåŸºäºè§‚å¯Ÿå¾—å‡ºç»“è®º                                â”‚
â”‚ "ä¸¤ä¸ªå·¥å…·éƒ½æ²¡æœ‰æ‰¾åˆ°ä¿¡æ¯ï¼Œæˆ‘åº”è¯¥ä¸»åŠ¨è¯¢é—®ç”¨æˆ·"               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœ€ç»ˆç­”æ¡ˆ:                                                  â”‚
â”‚ "æˆ‘æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ä¿¡æ¯ã€‚è¯·å‘Šè¯‰æˆ‘ä½ çš„å·¥ä½œåå¥½ï¼Œæˆ‘ä¼šè®°ä½çš„"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµ‹è¯•ç»“æœ

**APIå“åº”**:
```json
{
  "bot_message": {
    "content": "I don't currently have any stored information...",
    "metadata": {
      "model": "deepseek-ai/DeepSeek-V3.2",
      "react_iterations": 2,
      "tokens_used": 2745,
      "tool_calls": [
        {
          "tool": "memory_recall",
          "args": "{\"query\": \"å·¥ä½œåå¥½ work preferences\"}",
          "success": true,
          "result": "æ²¡æœ‰æ‰¾åˆ°ç›¸å…³è®°å¿†"
        },
        {
          "tool": "knowledge_search",
          "args": "{\"query\": \"å·¥ä½œåå¥½\"}",
          "success": true,
          "result": "çŸ¥è¯†åº“ä¸­æ²¡æœ‰æ‰¾åˆ°ç›¸å…³å†…å®¹"
        }
      ]
    }
  }
}
```

### æŠ€æœ¯ä¼˜åŠ¿

1. **è‡ªä¸»æ¨ç†**: AIè‡ªä¸»å†³å®šä½•æ—¶ä½¿ç”¨å·¥å…·
2. **å¤šæ­¥æ¨ç†**: æ”¯æŒè¿ç»­å¤šæ¬¡å·¥å…·è°ƒç”¨
3. **ä¸Šä¸‹æ–‡ä¿æŒ**: å®Œæ•´ä¿ç•™æ¨ç†é“¾è·¯
4. **é”™è¯¯å®¹é”™**: å·¥å…·å¤±è´¥ä¸å½±å“æœ€ç»ˆå›å¤
5. **å¯è§‚æµ‹æ€§**: å®Œæ•´è®°å½•å·¥å…·è°ƒç”¨è¿‡ç¨‹

### å¯æ‰©å±•å·¥å…·

**æœªæ¥å¯æ·»åŠ çš„å·¥å…·**:
- `web_search`: ç½‘ç»œæœç´¢
- `datetime`: è·å–å½“å‰æ—¶é—´
- `calculator`: æ•°å­¦è®¡ç®—
- `file_operations`: æ–‡ä»¶è¯»å†™
- `api_call`: è°ƒç”¨å¤–éƒ¨API
- `database_query`: æ•°æ®åº“æŸ¥è¯¢

### ä½¿ç”¨æ–¹å¼

**è‡ªåŠ¨å¯ç”¨**: æ‰€æœ‰Botè‡ªåŠ¨è·å¾—ReActèƒ½åŠ›

**å·¥å…·åˆ†é…**: æ ¹æ®Botç±»å‹è‡ªåŠ¨åˆ†é…åˆé€‚å·¥å…·

**æ— æ„ŸçŸ¥ä½¿ç”¨**: ç”¨æˆ·æ­£å¸¸å¯¹è¯ï¼ŒAIè‡ªä¸»å†³å®šæ˜¯å¦ä½¿ç”¨å·¥å…·

---

## ğŸ¯ v0.1 æ›´æ–°æ—¥å¿— - AIæ¨¡å‹é›†æˆå®Œæˆ (2026-02-20)

### æ–°å¢åŠŸèƒ½

#### 1. AIæœåŠ¡å±‚ ([backend/src/services/ai.service.ts](backend/src/services/ai.service.ts))

**é›†æˆSiliconFlow API**:
- æ”¯æŒæ¨¡å‹: DeepSeek-V3.2
- APIç«¯ç‚¹: `https://api.siliconflow.cn/v1/chat/completions`
- è®¤è¯æ–¹å¼: Bearer Token
- ç¯å¢ƒå˜é‡: `SILICONFLOW_API_KEY`

**æ ¸å¿ƒåŠŸèƒ½**:
```typescript
- generateResponse(messages, botConfig): ç”ŸæˆAIå›å¤
- isConfigured(): æ£€æŸ¥APIé…ç½®çŠ¶æ€
- getCurrentModel(): è·å–å½“å‰æ¨¡å‹åç§°
- getFallbackResponse(): APIå¤±è´¥æ—¶çš„é™çº§ç­–ç•¥
```

**æ”¯æŒçš„é…ç½®å‚æ•°**:
```typescript
interface BotConfig {
  model?: string;              // æ¨¡å‹åç§°ï¼Œé»˜è®¤ 'deepseek-ai/DeepSeek-V3.2'
  temperature?: number;        // æ¸©åº¦å‚æ•° 0-1ï¼Œé»˜è®¤ 0.7
  max_tokens?: number;         // æœ€å¤§tokenæ•°ï¼Œé»˜è®¤ 2048
  system_prompt?: string;      // ç³»ç»Ÿæç¤ºè¯
  enable_thinking?: boolean;   // å¯ç”¨æ€è€ƒæ¨¡å¼
  thinking_budget?: number;    // æ€è€ƒtokené¢„ç®—
  top_p?: number;             // top_pé‡‡æ ·ï¼Œé»˜è®¤ 0.7
}
```

#### 2. ChatæœåŠ¡é›†æˆ ([backend/src/services/chat.service.ts](backend/src/services/chat.service.ts))

**æ¶ˆæ¯å‘é€æµç¨‹**:
```
ç”¨æˆ·å‘é€æ¶ˆæ¯
  â†“
1. åŠ è½½å¯¹è¯å†å²ï¼ˆæœ€è¿‘20æ¡æ¶ˆæ¯ï¼‰
  â†“
2. æ„å»ºChatMessageæ•°ç»„ï¼ˆuser/assistantè§’è‰²ï¼‰
  â†“
3. è·å–Boté…ç½®ï¼ˆAIå‚æ•°ï¼‰
  â†“
4. è°ƒç”¨AIæœåŠ¡ç”Ÿæˆå›å¤
  â†“
5. ä¿å­˜ç”¨æˆ·æ¶ˆæ¯å’ŒAIå›å¤åˆ°æ•°æ®åº“
  â†“
6. è®°å½•æ¨¡å‹å…ƒæ•°æ®ï¼ˆmodel, generated_atï¼‰
```

**å…³é”®å®ç°**:
```typescript
// åŠ è½½å¯¹è¯å†å²ä¸Šä¸‹æ–‡
const messageHistory = await prisma.message.findMany({
  where: { conversation_id: conversationId },
  orderBy: { timestamp: 'asc' },
  take: 20 // æœ€è¿‘20æ¡æ¶ˆæ¯
});

// æ„å»ºAIæ¶ˆæ¯æ ¼å¼
const chatMessages: ChatMessage[] = messageHistory
  .filter(msg => msg.sender_type !== 'system')
  .map(msg => ({
    role: msg.sender_type === 'user' ? 'user' : 'assistant',
    content: msg.content
  }));

// è°ƒç”¨AIç”Ÿæˆå›å¤
const aiResponse = await aiService.generateResponse(
  chatMessages,
  botConfig || undefined
);

// ä¿å­˜AIå›å¤ï¼ˆå«å…ƒæ•°æ®ï¼‰
await tx.message.create({
  data: {
    message_id: `msg_${randomUUID()}`,
    conversation_id: conversationId,
    sender_type: 'bot',
    sender_id: userId,
    content: aiResponse,
    metadata: {
      model: botConfig?.model || 'deepseek-ai/DeepSeek-V3.2',
      generated_at: new Date().toISOString()
    }
  }
});
```

#### 3. ç¯å¢ƒé…ç½® ([backend/.env](backend/.env))

```bash
# SiliconFlow API (DeepSeek-V3.2)
SILICONFLOW_API_KEY="sk-itnytfacpeobkvireovadmsrbonrgemrsnfgsqvhesjtyppz"
```

### æ•°æ®æµè½¨è¿¹

#### å®Œæ•´çš„æ¶ˆæ¯å‘é€ä¸AIå›å¤æµç¨‹ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯ (chat.js)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ POST /api/chat/conversations/:id/messages
                              â”‚ { content: "ä½ å¥½" }
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              åç«¯è·¯ç”± (chat.ts:97-127)                          â”‚
â”‚  - éªŒè¯JWT Token                                                â”‚
â”‚  - æå–conversationIdå’Œcontent                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ chatService.sendMessage(userId, conversationId, content)
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ChatæœåŠ¡ (chat.service.ts:75-116)                     â”‚
â”‚  1. éªŒè¯å¯¹è¯å½’å±æƒ                                               â”‚
â”‚  2. åŠ è½½å¯¹è¯å†å²ï¼ˆæœ€è¿‘20æ¡ï¼‰                                     â”‚
â”‚  3. æ„å»ºAIæ¶ˆæ¯æ•°ç»„                                               â”‚
â”‚  4. è·å–Boté…ç½®                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ aiService.generateResponse(chatMessages, botConfig)
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           AIæœåŠ¡ (ai.service.ts:33-78)                          â”‚
â”‚  1. æ£€æŸ¥API Keyé…ç½®                                              â”‚
â”‚  2. æ„å»ºè¯·æ±‚ä½“ï¼ˆmodel, messages, parametersï¼‰                    â”‚
â”‚  3. è°ƒç”¨SiliconFlow API                                          â”‚
â”‚     POST https://api.siliconflow.cn/v1/chat/completions          â”‚
â”‚  4. è§£æå“åº”ï¼Œæå–AIå›å¤å†…å®¹                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ HTTP Response (AIç”Ÿæˆçš„æ–‡æœ¬)
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ•°æ®åº“äº‹åŠ¡ (Prisma)                                 â”‚
â”‚  1. ä¿å­˜ç”¨æˆ·æ¶ˆæ¯                                                 â”‚
â”‚     { sender_type: 'user', content: "ä½ å¥½" }                     â”‚
â”‚  2. ä¿å­˜AIæ¶ˆæ¯                                                   â”‚
â”‚     { sender_type: 'bot', content: AIå›å¤,                       â”‚
â”‚       metadata: { model, generated_at } }                        â”‚
â”‚  3. æ›´æ–°å¯¹è¯æ—¶é—´æˆ³                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ { user_message, bot_message }
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å“åº”è¿”å› (HTTP 201)                                 â”‚
â”‚  è¿”å›ç»™å‰ç«¯ï¼Œå‰ç«¯æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯å’ŒAIå›å¤                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµ‹è¯•éªŒè¯

#### APIæµ‹è¯•ç»“æœï¼š

**è¯·æ±‚**:
```bash
POST /api/chat/conversations/conv_1d0571ce-33ff-4e42-b548-ed24205e94af/messages
Authorization: Bearer eyJhbGc...
Content-Type: application/json

{
  "content": "Hello, what can you do?"
}
```

**å“åº”**:
```json
{
  "user_message": {
    "message_id": "msg_a06d6141-d823-4325-be9e-5195730e7426",
    "sender_type": "user",
    "content": "Hello, what can you do?"
  },
  "bot_message": {
    "message_id": "msg_7948cad7-d927-43c6-8b9d-ae35dc33453b",
    "sender_type": "bot",
    "content": "I can help you with a wide range of tasks, such as:\n\n- Answering questions and explaining concepts\n- Writing, editing, and translating texts\n- Assisting with learning, planning, or problem-solving\n- Offering suggestions and creative ideas\n- Discussing topics in technology, science, culture, and more\n\nIf you have something specific in mind, feel free to let me know â€” I'm here to assist! ğŸ˜Š",
    "metadata": {
      "model": "deepseek-ai/DeepSeek-V3.2",
      "generated_at": "2026-02-20T14:16:37.660Z"
    }
  }
}
```

**åç«¯æ—¥å¿—**:
```
âœ… AI Response generated (378 tokens)
```

### æŠ€æœ¯å®ç°ç»†èŠ‚

#### 1. é”™è¯¯å¤„ç†ç­–ç•¥
- APIè°ƒç”¨å¤±è´¥æ—¶è‡ªåŠ¨é™çº§åˆ°fallbackå›å¤
- æç¤ºç”¨æˆ·é…ç½®API Key
- ä¿è¯ç”¨æˆ·ä½“éªŒä¸ä¸­æ–­

#### 2. ä¸Šä¸‹æ–‡ç®¡ç†
- ä¿ç•™æœ€è¿‘20æ¡æ¶ˆæ¯ä½œä¸ºä¸Šä¸‹æ–‡
- è‡ªåŠ¨è¿‡æ»¤systemæ¶ˆæ¯
- ä¿æŒå¯¹è¯è¿è´¯æ€§

#### 3. å…ƒæ•°æ®è¿½è¸ª
- è®°å½•ä½¿ç”¨çš„æ¨¡å‹åç§°
- è®°å½•ç”Ÿæˆæ—¶é—´æˆ³
- ä¾¿äºåç»­åˆ†æå’Œè°ƒè¯•

#### 4. é…ç½®çµæ´»æ€§
- æ¯ä¸ªBotå¯ç‹¬ç«‹é…ç½®AIå‚æ•°
- æ”¯æŒè‡ªå®šä¹‰ç³»ç»Ÿæç¤ºè¯
- æ”¯æŒè°ƒæ•´æ¸©åº¦ã€tokenç­‰å‚æ•°

### ä½¿ç”¨æŒ‡å—

#### å‰ç«¯ä½¿ç”¨ï¼š
1. æ‰“å¼€èŠå¤©ç•Œé¢: http://localhost:8080/bot-chat-ui-v2.html
2. é€‰æ‹©ä»»æ„Botè¿›è¡Œå¯¹è¯
3. å‘é€æ¶ˆæ¯ï¼Œæ¥æ”¶AIå®æ—¶å›å¤

#### Boté…ç½®ï¼š
åœ¨ç®¡ç†åå°ç¼–è¾‘Botï¼Œå¯ä»¥è®¾ç½®ï¼š
```json
{
  "model": "deepseek-ai/DeepSeek-V3.2",
  "temperature": 0.7,
  "max_tokens": 2048,
  "system_prompt": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åŠ©æ‰‹...",
  "enable_thinking": true
}
```

### æ¶æ„ä¼˜åŠ¿

1. **æœåŠ¡è§£è€¦**: AIæœåŠ¡ç‹¬ç«‹å°è£…ï¼Œæ˜“äºæ‰©å±•å…¶ä»–æ¨¡å‹
2. **é”™è¯¯å®¹é”™**: APIå¤±è´¥æ—¶æœ‰é™çº§ç­–ç•¥
3. **ä¸Šä¸‹æ–‡ä¿æŒ**: è‡ªåŠ¨ç®¡ç†å¯¹è¯å†å²
4. **çµæ´»é…ç½®**: æ¯ä¸ªBotç‹¬ç«‹é…ç½®
5. **å…ƒæ•°æ®è¿½è¸ª**: å®Œæ•´è®°å½•AIç”Ÿæˆä¿¡æ¯

---

**æ–‡æ¡£ç»´æŠ¤**: æœ¬æ–‡æ¡£å°†éšé¡¹ç›®æ¼”è¿›æŒç»­æ›´æ–°
**è”ç³»æ–¹å¼**: [é¡¹ç›®GitHub] (å¦‚æœ‰)
**è®¸å¯åè®®**: [å¾…å®š]
