# Bot Agent Platform - 开机自启配置

## 一键配置（推荐）

**右键点击 `install-startup.ps1`，选择"以管理员身份运行"**

配置完成后，下次重启电脑时会自动启动：
1. ✅ Docker Desktop
2. ✅ PostgreSQL 数据库
3. ✅ Redis 缓存
4. ✅ 后端服务（端口 8915）

---

## 手动配置步骤

### 1. 启动 Docker Desktop 开机自启

1. 打开 Docker Desktop
2. 点击右上角齿轮图标 ⚙️ (Settings)
3. 选择 "General"
4. 勾选 ✅ **"Start Docker Desktop when you sign in to Windows"**
5. 点击 "Apply & Restart"

### 2. 创建 Windows 启动任务

**方法 A：使用提供的脚本**
- 双击运行 `startup.bat` 测试是否正常
- 将 `startup.bat` 的快捷方式放到启动文件夹：
  - 按 `Win + R`
  - 输入 `shell:startup` 回车
  - 复制 `startup.bat` 的快捷方式到此文件夹

**方法 B：使用任务计划程序（更可靠）**
1. 按 `Win + R`，输入 `taskschd.msc` 回车
2. 右侧点击 "创建基本任务"
3. 名称：`Bot Agent Platform Auto Start`
4. 触发器：当用户登录时
5. 操作：启动程序
6. 程序：`F:\samlay-c\agent-group\startup.bat`
7. 勾选 "当单击完成时，打开此任务属性的对话框"
8. 在 "常规" 标签页，勾选 "使用最高权限运行"
9. 点击 "确定"

---

## 验证是否配置成功

### 测试启动脚本
```bash
# 双击运行 startup.bat
# 或者命令行执行
F:\samlay-c\agent-group\startup.bat
```

### 检查服务状态
```bash
# 检查 Docker 容器
docker ps

# 检查后端服务
pm2 status

# 访问健康检查
curl http://localhost:8915/health
```

### 重启电脑测试
重启后访问：http://localhost:8915/login.html

---

## 卸载开机自启

### 删除启动任务
1. 按 `Win + R`
2. 输入 `shell:startup` 回车
3. 删除 `Bot-Agent-Platform.lnk` 和 `Docker-Desktop.lnk`

### 或使用任务计划程序
1. 按 `Win + R`，输入 `taskschd.msc`
2. 找到并删除 `Bot Agent Platform Auto Start`

---

## 故障排查

### Docker Desktop 未启动
- 检查 Docker Desktop 是否安装
- 确认已开启开机自启（参考步骤1）

### 数据库连接失败
```bash
# 检查数据库状态
docker ps | grep postgres

# 手动启动数据库
docker-compose up -d
```

### 后端服务未启动
```bash
# 检查 PM2 状态
pm2 status

# 手动启动后端
cd F:\samlay-c\agent-group\backend
npm run pm2:start
```

### 查看日志
```bash
# PM2 日志
pm2 logs bot-agent-platform

# Docker 日志
docker logs bot_agent_db
docker logs bot_agent_redis
```

---

## 访问地址

- 登录页：http://localhost:8915/login.html
- 管理后台：http://localhost:8915/bot-admin-ui-v2.html
- 聊天界面：http://localhost:8915/bot-chat-ui-v2.html
- API 文档：http://localhost:8915/health

默认账号（首次启动需要创建）：
- 管理员：admin / admin123
